<div class="ejercicios-container">
  <div class="page-header">
    <h1>PrÃ¡ctica con IA</h1>
    <p>Genera ejercicios personalizados y recibe retroalimentaciÃ³n instantÃ¡nea</p>
  </div>

  <!-- Panel de GeneraciÃ³n -->
  <div class="generation-panel">
    <div class="panel-header">
      <h2>Generar Nuevo Ejercicio</h2>
      <button 
        (click)="generarEjercicio()" 
        [disabled]="cargando" 
        class="btn-generate">
        @if (cargando) {
          ğŸ”„ Generando...
        } @else {
          ğŸš€ Generar Ejercicio
        }
      </button>
    </div>

    @if (ejercicioGenerado) {
      <div class="ejercicio-section">
        <div class="section-header">
          <h3>ğŸ“ Ejercicio Generado</h3>
          <button (click)="limpiarEjercicio()" class="btn-clear">ğŸ—‘ï¸ Limpiar</button>
        </div>
        <div class="ejercicio-content">
          <pre>{{ ejercicioGenerado }}</pre>
        </div>
      </div>
    }
  </div>

  @if (ejercicioGenerado) {
    <!-- Panel de Respuesta -->
    <div class="response-panel">
      <h3>âœï¸ Tu SoluciÃ³n</h3>
      <textarea 
        [(ngModel)]="respuestaUsuario" 
        placeholder="Escribe tu cÃ³digo o soluciÃ³n aquÃ­..."
        rows="10"
        class="response-textarea">
      </textarea>
      
      <button 
        (click)="evaluarRespuesta()" 
        [disabled]="evaluando || !respuestaUsuario.trim()"
        class="btn-evaluate">
        @if (evaluando) {
          ğŸ” Evaluando...
        } @else {
          âœ… Evaluar Respuesta
        }
      </button>
    </div>
  }

  @if (evaluacion) {
    <!-- Panel de EvaluaciÃ³n -->
    <div class="evaluation-panel">
      <h3>ğŸ“Š Resultado de la EvaluaciÃ³n</h3>
      <div class="evaluation-result" [class.correct]="evaluacion.correcto" [class.incorrect]="!evaluacion.correcto">
        <div class="result-header">
          <span class="result-icon">
            @if (evaluacion.correcto) {
              âœ…
            } @else {
              âŒ
            }
          </span>
          <span class="result-text">
            @if (evaluacion.correcto) {
              Â¡Correcto!
            } @else {
              Necesitas mejorar
            }
          </span>
        </div>
        
        <div class="result-details">
          <div class="detail-section">
            <h4>ğŸ“– ExplicaciÃ³n:</h4>
            <p>{{ evaluacion.explicacion }}</p>
          </div>
          
          @if (evaluacion.sugerencias) {
            <div class="detail-section">
              <h4>ğŸ’¡ Sugerencias:</h4>
              <p>{{ evaluacion.sugerencias }}</p>
            </div>
          }
        </div>
      </div>
    </div>
  }

  <!-- Historial -->
  <div class="history-panel">
    <h3>ğŸ“‹ Historial de PrÃ¡ctica</h3>
    @if (historial.length === 0) {
      <div class="empty-history">
        <p>AÃºn no has completado ejercicios. Â¡Comienza a practicar!</p>
      </div>
    }
    
    @if (historial.length > 0) {
      <div class="history-list">
        @for (item of historial; track item.id) {
          <div class="history-item" [class.correct]="item.correcto">
            <div class="history-status">
              <span class="status-icon">
                @if (item.correcto) {
                  âœ…
                } @else {
                  âŒ
                }
              </span>
            </div>
            <div class="history-content">
              <p class="history-question">{{ item.pregunta }}</p>
              <span class="history-date">{{ item.fecha | date:'medium' }}</span>
            </div>
          </div>
        }
      </div>
    }
  </div>
</div>